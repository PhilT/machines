# Take the name from the key unless name is specified
# added project name plus .git to scm to git clone
# use main key subdir for appsroot for given user
# Add #{webapp}.local to localhosts on development environments
# Set server configs to use staging.#{url} for staging environments
# Set server configs to use #{url} for production environments
# Use SSL by default
# check why we were setting db_password for webapps

package :load_machines
package :questions

package :dependencies
package :timezone
package :base
package :virtualbox_guest if AppConf.machine = 'philworkstation'

only :roles => :app do
  package :monit unless AppConf.environment == :development
  package :webapps
  package :dotfiles
  package :git
  package :rvm
  package :ruby
  package :nginx
  package :passenger
  package :passenger_nginx
  package :nginx_logrotate
  package :postfix unless AppConf.environment == :development
end

only :roles => :db do
  package :mysql
end

only :users => 'phil' do
  package :openbox
  package :apps
  package :chrome
  package :firefox
  package :gmate
  package :docky
  package :unison
end

sudo upgrade

package :save_machines

